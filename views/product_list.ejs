<div class="page-intro">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-10">
                <ol class="breadcrumb">
                    <li><i class="fa fa-th-large pr-10"></i>产品分类: </li>
                    <li class="active"><a href="/filter/?category=clothing_shoes">服装鞋子</a></li>
                    <li class="active"><a href="/filter/?category=food">食品饮食</a></li>
                    <li class="active"><a href="/filter/?category=kitchenware">厨房用具</a></li>
                    <li class="active"><a href="/filter/?category=electronic_product">电子产品</a></li>
                    <li class="active"><a href="/filter/?category=maternal">母婴</a></li>
                    <li class="active"><a href="/filter/?category=cosmetic">化妆品</a></li>
                    <li class="active"><a href="/filter/?category=health">健康保健</a></li>
                    <li class="active"><a href="/filter/?category=tourism">运动旅行</a></li>
                    <li class="active"><a href="/filter/?category=home_appliances">居家用品</a></li>
                    <li class="active"><a href="/filter/?category=jewelry_watches">钟表手饰</a></li>
                    <li class="active"><a href="/filter/?category=office">办公</a></li>
                    <li class="active"><a href="/filter/?category=other">其他</a></li>
                </ol>
            </div>
            <div class="col-md-2">
                <form role="search" class="search-box" action="/filter" style="margin: 0 !important;">
                    <div class="has-feedback">
                        <input type="text" class="form-control" placeholder="搜索产品" name="search" style="-webkit-appearance: textfield; border-radius: 25px">
                        <i class="fa fa-search form-control-feedback"></i>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- main-container start -->
<!-- ================ -->
<section class="main-container">
    <div class="container-fluid">
        <div class="row">
            <div class="main col-md-10">
                <h2 class="page-title">精选商品</h2>
                <div class="separator-2"></div>
                <div id="container" class="row">
                    <% products.forEach(function(product, index) { %>
                    <div class="element col-lg-3 col-md-3 col-sm-6 col-xs-6 masonry-grid-item">
                        <div class="listing-item">
                            <div class="overlay-container">
                                <img src="<%= product.Images %>" onerror="this.src= '/images/no-image.jpg';" />
                                <a href="/product?product_id=<%= product.ProductId %>" class="overlay small">
                                    <i class="fa fa-search-plus"></i>
                                    <span>
                                    <% for (var l = product.DescriptionCN.length, i = 0; i < l; i++) { %>
                                        <% desc = product.DescriptionCN[i]%>
                                        <% if (desc !== "") { %>
                                            <%= desc.replace(/<\/?[^>]+(>|$)/g, "") %>
                                            <% break %>
                                        <% } %>
                                    <% } %>
                                    </span>
                                </a>
                            </div>
                            <div class="listing-item-body clearfix">
                                <h3 class="title" style="font-weight: 300">
                                    <a href="/product?product_id=<%= product.ProductId %>">
                                    <% for (var l = product.ProductName.length, i = 0; i < l; i++) { %>
                                        <% name = product.ProductName[i]%>
                                        <% if (name !== "") { %>
                                            <%= name %>
                                            <% break %>
                                        <% } %>
                                    <% } %>
                                    </a>
                                </h3>
                                <% if (product.Price.length == 1 || Math.min.apply(null, product.Price) == Math.max.apply(null, product.Price)) { %>
                                <span class="price" style="font-size: 20px"><%= product.Price[0].toString().replace(".", ",") %> €</span>
                                <% } else { %>
                                <span class="price" style="font-size: 20px"><%= Math.min.apply(null,product.Price).toString().replace(".", ",") %> - <%= Math.max.apply(null,product.Price).toString().replace(".", ",") %> €</span>
                                <% } %>
                                <div class="elements-list pull-right">
                                    <a href="/product?product_id=<%= product.ProductId %>"><i class="fa fa-gift pr-10"></i>去看看</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% }); %>
                </div>
                <div class="clearfix"></div>
                <ul class="pagination"></ul>
            </div>
            <aside class="col-md-2">
                <div class="siderbar">
                    <div class="clearfixed">
                        <h3>筛选</h3>
                        <div class="separator"></div>
                        <div class="sorting-filters">
                            <form role="form" action="/filter">
                                <div class="form-group">
                                    <label>种类</label>
                                    <select class="form-control" name="category">
                                        <option value="all" <% if(category=='all') { %> selected='selected' <% } %>>所有</option>
                                        <option value="clothing_shoes" <% if(category=='服装鞋子') { %> selected='selected' <% } %>>服装鞋子</option>
                                        <option value="food" <% if(category=='食品饮食') { %> selected='selected' <% } %>>食品饮食</option>
                                        <option value="kitchenware" <% if(category=='厨房用具') { %> selected='selected' <% } %>>厨房用具</option>
                                        <option value="electronic_product" <% if(category=='电子产品') { %> selected='selected' <% } %>>电子产品</option>
                                        <option value="maternal" <% if(category=='母婴') { %> selected='selected' <% } %>>母婴</option>
                                        <option value="cosmetic" <% if(category=='化妆品') { %> selected='selected' <% } %>>化妆品</option>
                                        <option value="health" <% if(category=='健康保健') { %> selected='selected' <% } %> >健康保健</option>
                                        <option value="tourism" <% if(category=='运动旅行') { %> selected='selected' <% } %> >运动旅行</option>
                                        <option value="home_appliances" <% if(category=='居家用品') { %> selected='selected' <% } %> >居家用品</option>
                                        <option value="jewelry_watches" <% if(category=='钟表手饰') { %> selected='selected' <% } %> >钟表手饰</option>
                                        <option value="office" <% if(category=='办公') { %> selected='selected' <% } %> >办公</option>
                                        <option value="other" <% if(category=='其他') { %> selected='selected' <% } %> >其他</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>价格区间 (€)</label>
                                    <div class="row grid-space-10">
                                        <div class="col-sm-6">
                                            <input type="text" name="minprice" class="form-control" placeholder='最低价格' value="<%= minprice %>">
                                        </div>
                                        <div class="col-sm-6">
                                            <input type="text" name="maxprice" class="form-control col-xs-6" placeholder='最高价格' value="<%= maxprice %>">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>排序</label>
                                    <select class="form-control" name="sort">
                                        <option value="date" <% if(sort=='date') { %> selected='selected' <% } %>>按日期</option>
                                        <option value="price_asc" <% if(sort=='price_asc') { %> selected='selected' <% } %>>按价格由低到高</option>
                                        <option value="price_desc" <% if(sort=='price_desc') { %> selected='selected' <% } %>>按价格由高到低</option>
                                        <option value="rank" <% if(sort=='rank') { %> selected='selected' <% } %>>按热度</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>品牌</label>
                                    <select class="form-control" name="brand">
                                        <option value="all" <% if(brand=='all') { %> selected='selected' <% } %>>所有</option>
                                        <% brands.forEach(function(_brand, index) { %>
                                            <% if (_brand._id != "" && _brand._id != "unbekannt" && _brand._id != null) { %>
                                                <option value="<%= _brand._id %>" <% if(brand==_brand._id) { %> selected='selected' <% } %>><%= _brand._id %> (<%= _brand.Sum %>)</option>
                                            <% } %>
                                        <% }) %>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <button type="submit" class="btn btn-default">确认</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>
</section>
<!-- main-container end -->
<!-- section start -->
<!-- ================ -->
<script type="text/javascript">
$(document).ready(function() {
    $(".overlay-container img").css({
        "min-height": "100px"
    });
    
    var $container = $('#container');
    $container.imagesLoaded(function() {
        $container.isotope({
            masonry: {
                columnWidth: ('.masonry-grid-item')
            }
        });
    });

    $('.pagination').pagination({
        pages: <%= pages %> ,
        currentPage: <%= currentPage %>,
        hrefTextPrefix: getURL(),
        prevText: "上一页",
        nextText: "下一页"
    });
});

</script>
